<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="prism">
<title>Download and plot PRISM data • prism</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download and plot PRISM data">
<meta property="og:description" content="prism">
<meta property="og:image" content="https://docs.ropensci.org/prism/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">prism</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item">
  <a class="nav-link" href="../articles/prism.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/prism/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Download and plot PRISM data</h1>
                        <h4 data-toc-skip class="author">Alan Butler</h4>
            
            <h4 data-toc-skip class="date">2024-03-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/prism/blob/HEAD/vignettes/prism.Rmd" class="external-link"><code>vignettes/prism.Rmd</code></a></small>
      <div class="d-none name"><code>prism.Rmd</code></div>
    </div>

    
    
<p><strong>Previous Versions:</strong></p>
<ul>
<li>Edmund Hart - November 13, 2015</li>
</ul>
<p>The prism package allows users to access and visualize data from the <a href="https://prism.nacse.org" class="external-link">Oregon State PRISM project</a>. Data are all in the form of gridded rasters for the continental US at 4 different temporal scales: daily, monthly, annual, and 30 year normals. Please see their webpage for a full description of the data products, or <a href="https://www.prism.oregonstate.edu/documents/PRISM_datasets.pdf" class="external-link">see their overview</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>prism is available on CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"prism"</span><span class="op">)</span></span></code></pre></div>
<p>Or the development version can be installed from GitHub with devtools:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ropensci/prism"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quickstart">Quickstart<a class="anchor" aria-label="anchor" href="#quickstart"></a>
</h2>
<p>The overall work flow in the prism package is (links go to details on this page):</p>
<ol style="list-style-type: decimal">
<li>
<a href="#downloading-data">Set the download directory</a>, i.e., the folder on your computer that prism data will be saved to: <code><a href="../reference/prism_set_dl_dir.html">prism_set_dl_dir()</a></code>. This is now referred to as the “prism archive”.</li>
<li>
<a href="#download-30-year-normal-data">Download prism data to the archive:</a> <code>get_prism_*()</code>. Each folder, or variable, timestep, day/month/year is stored in a single folder in the archive and referred to as prism data (<code>pd</code>).</li>
<li>
<a href="#interact-with-the-archive-and-prism-data">Interact with the prism archive:</a> <code>prism_archive_*()</code>. Or interact with the prism data: <code>pd_*()</code>.</li>
</ol>
<p>The remainder of this README provides examples following this work flow.</p>
</div>
<div class="section level2">
<h2 id="prism-data-and-parameters">prism data and parameters<a class="anchor" aria-label="anchor" href="#prism-data-and-parameters"></a>
</h2>
<p>Data are available in 4 different temporal scales as mentioned above. At each temporal scale, there are 7 different parameters/variables available. Keep in mind these are modeled parameters, not measured. Please see the <a href="https://www.prism.oregonstate.edu/documents/PRISM_datasets.pdf" class="external-link">full description</a> for how they are calculated.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Parameter name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><em>tmean</em></td>
<td align="left">Mean temperature</td>
</tr>
<tr class="even">
<td align="left"><em>tmax</em></td>
<td align="left">Maximum temperature</td>
</tr>
<tr class="odd">
<td align="left"><em>tmin</em></td>
<td align="left">Minimum temperature</td>
</tr>
<tr class="even">
<td align="left"><em>tdmean</em></td>
<td align="left">Mean dew point temperature</td>
</tr>
<tr class="odd">
<td align="left"><em>ppt</em></td>
<td align="left">Total precipitation (rain and snow)</td>
</tr>
<tr class="even">
<td align="left"><em>vpdmin</em></td>
<td align="left">Daily minimum vapor pressure deficit</td>
</tr>
<tr class="odd">
<td align="left"><em>vpdmax</em></td>
<td align="left">Daily maximum vapor pressure deficit</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="downloading-data">Downloading data<a class="anchor" aria-label="anchor" href="#downloading-data"></a>
</h2>
<p>Before downloading any data, set the directory that the prism data will be saved to:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/prism/">prism</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/prism_set_dl_dir.html">prism_set_dl_dir</a></span><span class="op">(</span><span class="st">"~/prismtmp"</span><span class="op">)</span></span></code></pre></div>
<p>This is now referred to as the “prism archive”. The <code>prism_archive_*()</code> functions allow the user to search through the archive. The prism archive contains “prism data”. The prism data are referred to by their folder names, even though the “real” data are the .bil, .txt, and other files that exist in the folder. The prism data (<code>pd</code>) can be accessed using the <code>pd_*()</code> functions.</p>
<div class="section level3">
<h3 id="download-30-year-normal-data">Download 30-year normal data<a class="anchor" aria-label="anchor" href="#download-30-year-normal-data"></a>
</h3>
<p>Normals are based on the latest 30-year period; currently 1981 - 2010. Normals can be downloaded in two resolutions, 4km and 800m, and a resolution must be specified. They can be downloaded for a given month, vector of months, or annual averages for all 30 years.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download the January - June 30-year averages at 4km resolution</span></span>
<span><span class="fu"><a href="../reference/get_prism_data.html">get_prism_normals</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"tmean"</span>, resolution <span class="op">=</span> <span class="st">"4km"</span>, mon <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, keepZip <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download the 30-year annual average precip and annual average temperature</span></span>
<span><span class="fu"><a href="../reference/get_prism_data.html">get_prism_normals</a></span><span class="op">(</span><span class="st">"ppt"</span>, <span class="st">"4km"</span>, annual <span class="op">=</span> <span class="cn">TRUE</span>, keepZip <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_prism_data.html">get_prism_normals</a></span><span class="op">(</span><span class="st">"tmean"</span>, <span class="st">"4km"</span>, annual <span class="op">=</span> <span class="cn">TRUE</span>, keepZip <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>If the archive has not already been set, calling any of the <code>get_prism_*()</code> functions will prompt the user to specify the directory. prism data are downloaded as zip files and then unzipped. If the <code>keepZip</code> argument is <code>TRUE</code> the zip file will remain on your machine, otherwise it will be automatically deleted.</p>
</div>
<div class="section level3">
<h3 id="download-daily-monthly-and-annual-data">Download daily, monthly, and annual data<a class="anchor" aria-label="anchor" href="#download-daily-monthly-and-annual-data"></a>
</h3>
<p>Let us download daily average temperatures from June 1 to June 14, 2013. We can also download January average temperature data from 1982 to 2014. Finally, we will download annual average precipitation for 2000 to 2015.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_prism_data.html">get_prism_dailys</a></span><span class="op">(</span></span>
<span>  type <span class="op">=</span> <span class="st">"tmean"</span>, </span>
<span>  minDate <span class="op">=</span> <span class="st">"2013-06-01"</span>, </span>
<span>  maxDate <span class="op">=</span> <span class="st">"2013-06-14"</span>, </span>
<span>  keepZip <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_prism_data.html">get_prism_monthlys</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmean"</span>, year <span class="op">=</span> <span class="fl">1982</span><span class="op">:</span><span class="fl">2014</span>, mon <span class="op">=</span> <span class="fl">1</span>, keepZip <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_prism_data.html">get_prism_annual</a></span><span class="op">(</span><span class="st">"ppt"</span>, years <span class="op">=</span> <span class="fl">2000</span><span class="op">:</span><span class="fl">2015</span>, keepZip <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Note that for daily data you need to give a well formed date string in the form of “YYYY-MM-DD”.</p>
</div>
</div>
<div class="section level2">
<h2 id="interact-with-the-archive-and-prism-data">Interact with the archive and prism data<a class="anchor" aria-label="anchor" href="#interact-with-the-archive-and-prism-data"></a>
</h2>
<p>You can view all the prism data you have downloaded with a simple command: <code><a href="../reference/prism_archive_ls.html">prism_archive_ls()</a></code>. This function gives a list of folder names, i.e., prism data (<code>pd</code>). All the functions in the prism package work off of one or more of these folder names (<code>pd</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Truncated to keep file list short</span></span>
<span><span class="fu"><a href="../reference/prism_archive_ls.html">prism_archive_ls</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>While prism functions use this folder format, other files may need an absolute path (e.g. the <code>raster</code> package). The <code><a href="../reference/pd_get.html">pd_to_file()</a></code> function conveniently returns the absolute path. Alternatively, you may want to see what the normal name for the product is (not the file name), and we can get that with the <code><a href="../reference/pd_get.html">pd_get_name()</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Truncated to keep file list short</span></span>
<span><span class="fu"><a href="../reference/pd_get.html">pd_to_file</a></span><span class="op">(</span><span class="fu"><a href="../reference/prism_archive_ls.html">prism_archive_ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/pd_get.html">pd_get_name</a></span><span class="op">(</span><span class="fu"><a href="../reference/prism_archive_ls.html">prism_archive_ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally, <code><a href="../reference/prism_archive_subset.html">prism_archive_subset()</a></code> is a convenient way to search for specific parameters, time steps, days, months, years, or ranges of days, months, years.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we know we have downloaded June 2013 daily data, so lets search for those </span></span>
<span><span class="fu"><a href="../reference/prism_archive_subset.html">prism_archive_subset</a></span><span class="op">(</span><span class="st">"tmean"</span>, <span class="st">"daily"</span>, mon <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or we can look for days between June 7 and June 10</span></span>
<span><span class="fu"><a href="../reference/prism_archive_subset.html">prism_archive_subset</a></span><span class="op">(</span></span>
<span>  <span class="st">"tmean"</span>, <span class="st">"daily"</span>, minDate <span class="op">=</span> <span class="st">"2013-06-07"</span>, maxDate <span class="op">=</span> <span class="st">"2013-06-10"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="raster-plots">Raster plots<a class="anchor" aria-label="anchor" href="#raster-plots"></a>
</h3>
<p>You can easily make a quick plot of your data using the output of <code><a href="../reference/prism_archive_ls.html">prism_archive_ls()</a></code> or <code><a href="../reference/prism_archive_subset.html">prism_archive_subset()</a></code> with <code><a href="../reference/pd_image.html">pd_image()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the January 30-year average temperatures</span></span>
<span><span class="co"># grab only the first value, just in case multiple values are returned</span></span>
<span><span class="va">jmean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prism_archive_subset.html">prism_archive_subset</a></span><span class="op">(</span></span>
<span>  <span class="st">"tmean"</span>, <span class="st">"monthly normals"</span>, mon <span class="op">=</span> <span class="fl">1</span>, resolution <span class="op">=</span> <span class="st">"4km"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pd_image.html">pd_image</a></span><span class="op">(</span><span class="va">jmean</span><span class="op">)</span></span></code></pre></div>
<p>It is easy to load the prism data with the raster package. This time we will look at January temperature anomalies. To do this we will examine the difference between January 2013 and the January 30-year normals. Conveniently, we already downloaded these data. We just need to grab them out of our archive.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="co"># knowing the name of the files you are after allows you to find them in the </span></span>
<span><span class="co"># list of all files that exist</span></span>
<span><span class="co"># jnorm_name &lt;- "PRISM_tmean_30yr_normal_4kmM2_01_bil"</span></span>
<span><span class="co"># j2013_name &lt;- "PRISM_tmean_stable_4kmM3_201301_bil"</span></span>
<span><span class="co"># but we will use prism_archive_subset() to find the files we need</span></span>
<span></span>
<span><span class="va">jnorm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prism_archive_subset.html">prism_archive_subset</a></span><span class="op">(</span></span>
<span>  <span class="st">"tmean"</span>, <span class="st">"monthly normals"</span>, mon <span class="op">=</span> <span class="fl">1</span>, resolution <span class="op">=</span> <span class="st">"4km"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">j2013</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prism_archive_subset.html">prism_archive_subset</a></span><span class="op">(</span><span class="st">"tmean"</span>, <span class="st">"monthly"</span>, years <span class="op">=</span> <span class="fl">2013</span>, mon <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># raster needs a full path, not the "short" prism data name</span></span>
<span><span class="va">jnorm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pd_get.html">pd_to_file</a></span><span class="op">(</span><span class="va">jnorm</span><span class="op">)</span></span>
<span><span class="va">j2013</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pd_get.html">pd_to_file</a></span><span class="op">(</span><span class="va">j2013</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Now we'll load the rasters.</span></span>
<span><span class="va">jnorm_rast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">jnorm</span><span class="op">)</span></span>
<span><span class="va">j2013_rast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">j2013</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now we can do simple subtraction to get the anomaly by subtracting 2014 </span></span>
<span><span class="co"># from the 30 year normal map</span></span>
<span><span class="va">anomCalc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">anom_rast</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/overlay.html" class="external-link">overlay</a></span><span class="op">(</span><span class="va">j2013_rast</span>,<span class="va">jnorm_rast</span>,fun <span class="op">=</span> <span class="va">anomCalc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">anom_rast</span><span class="op">)</span></span></code></pre></div>
<p>The plot shows that January 2013 was warmer than the average over the last 30 years. It also shows how easy it is to use the raster library to work with prism data. The package provides a simple framework to work with a large number of rasters that you can easily download and visualize or use with other data sets.</p>
</div>
<div class="section level3">
<h3 id="single-grid-cell-plot">Single grid cell plot<a class="anchor" aria-label="anchor" href="#single-grid-cell-plot"></a>
</h3>
<p>You can also visualize a single point across multiple prism data files (slice) using <code><a href="../reference/pd_plot_slice.html">pd_plot_slice()</a></code>. This procedure will take a set of rasters, create a “<code><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">raster::stack</a></code>”, extract data at a point, and then create a ggplot2 object.</p>
<p>Let’s now make a plot of January temperatures in Boulder between 1982 and 2014. First we’ll grab all the data from the US (downloaded in the previous step), and then give our function a point to get data from. The point must be a vector in the form of longitude, latitude. Because <code><a href="../reference/pd_plot_slice.html">pd_plot_slice()</a></code> returns a gg object, it can be combined with other ggplot functions.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># data already exist in the prism dl dir</span></span>
<span><span class="va">boulder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">105.2797</span>, <span class="fl">40.0176</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prism_archive_subset() will return prism data that matches the specified </span></span>
<span><span class="co"># variable, time step, years, months, days, etc.</span></span>
<span><span class="va">to_slice</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prism_archive_subset.html">prism_archive_subset</a></span><span class="op">(</span><span class="st">"tmean"</span>, <span class="st">"monthly"</span>, mon <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pd_plot_slice.html">pd_plot_slice</a></span><span class="op">(</span><span class="va">to_slice</span>, <span class="va">boulder</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add a linear average and title</span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Average January temperature in Boulder, CO 1982-2014"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="leaflet-map">leaflet map<a class="anchor" aria-label="anchor" href="#leaflet-map"></a>
</h3>
<p>Finally, the prism data are in a form that can be used with leaflet maps (with the help of the raster package). The <a href="https://CRAN.R-project.org/package=leaflet" class="external-link">leaflet package</a> allows you to easily make JavaScript maps using the <a href="https://leafletjs.com/" class="external-link">leaflet</a> mapping framework using prism data. These can easily be hosted on websites like <a href="https://rpubs.com/" class="external-link">Rpubs</a> or your own site. Here is a simple example of plotting the <a href="https://rpubs.com/DistribEcology/122453" class="external-link">30-year normal for annual temperature</a>. If you run this code you will have an interactive map, instead of just the screen shot shown here.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/prism/">prism</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 30-year normal average temperature have already been downloaded for </span></span>
<span><span class="va">norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prism_archive_subset.html">prism_archive_subset</a></span><span class="op">(</span></span>
<span>  <span class="st">"tmean"</span>, <span class="st">"annual normals"</span>, resolution <span class="op">=</span> <span class="st">"4km"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">rast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="fu"><a href="../reference/pd_get.html">pd_to_file</a></span><span class="op">(</span><span class="va">norm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create color palette and plot</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">colorNumeric</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0000FF"</span>, <span class="st">"#FFFF00"</span>, <span class="st">"#FF0000"</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">rast</span><span class="op">)</span>,</span>
<span>  na.color <span class="op">=</span> <span class="st">"transparent"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">leaflet</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">addTiles</span><span class="op">(</span></span>
<span>    urlTemplate <span class="op">=</span> <span class="st">'http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">addRasterImage</span><span class="op">(</span><span class="va">rast</span>, colors <span class="op">=</span> <span class="va">pal</span>, opacity<span class="op">=</span><span class="fl">.65</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">addLegend</span><span class="op">(</span>pal <span class="op">=</span> <span class="va">pal</span>, values <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">rast</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Deg C"</span><span class="op">)</span></span></code></pre></div>
<p>[<img src="leaflet_example.png" alt="leaflet example figure"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
